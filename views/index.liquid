{% render "partials/head.liquid" %}

<h1>Lessons</h1>

<h2>Recommended Stories</h2>

<h2>Your playlists</h2>
<ul>
  {% for playlist in yourPlaylists %}
    {% render "partials/playlist-card.liquid"
      , playlist: playlist %}
  {% endfor %}
</ul>

<h2>All stories</h2>
<ul>
  {% for story in stories %}
    {% render "partials/story-card.liquid"
      , story: story %}
  {% endfor %}
</ul>

<h2>Liked playlists</h2>
<ul>
  {% for playlist in likedPlaylists %}
    {% render "partials/playlist-card.liquid"
      , playlist: playlist %}
  {% endfor %}
</ul>

<h2>Suggested playlists</h2>
<ul>
  {% for playlist in suggestedPlaylists %}
    {% render "partials/playlist-card.liquid"
      , playlist: playlist %}
  {% endfor %}
</ul>

{% render "partials/foot.liquid" %}

<script type="module">
  const baseURL = "https://fdnd-agency.directus.app/items/tm_";
  const defaultProfile = 124;
  
  if ('fetch' in window && 'DOMParser' in window) {
    document.addEventListener('submit', async function (event) {
      const form = event.target;
  
      if (!form.hasAttribute('data-enhanced')) {
        return;
      }
  
      event.preventDefault();
      form.classList.add('loading');
  
      const response = await fetch(form.action, {
        method: form.method,
        body: new URLSearchParams(new FormData(form))
      });
  
      const responseText = await response.text();
  
      const parser = new DOMParser();
      const responseDOM = parser.parseFromString(responseText, 'text/html');
  
      const newState = responseDOM.querySelector('[data-enhanced="' + form.getAttribute('data-enhanced') + '"]');
  
      // Hier wil je waarschijnlijk de Loading state vervangen door een Success state
      form.outerHTML = newState.outerHTML;
    });
  }
</script>